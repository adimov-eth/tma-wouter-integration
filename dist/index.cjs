"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const h=require("react");class g extends Error{constructor(e,a,s){super(a,{cause:s}),this.type=e,Object.setPrototypeOf(this,g.prototype)}}function b(t,e,a){return new g(t,e,a)}const C="ERR_UNEXPECTED_TYPE",$="ERR_PARSE";function y(){return b(C,"Value has unexpected type")}class E{constructor(e,a,s){this.parser=e,this.isOptional=a,this.type=s}parse(e){if(!(this.isOptional&&e===void 0))try{return this.parser(e)}catch(a){throw b($,`Unable to parse value${this.type?` as ${this.type}`:""}`,a)}}optional(){return this.isOptional=!0,this}}function _(t,e){return()=>new E(t,!1,e)}const p=_(t=>{if(typeof t=="boolean")return t;const e=String(t);if(e==="1"||e==="true")return!0;if(e==="0"||e==="false")return!1;throw y()},"boolean");function N(t,e){const a={};for(const s in t){const o=t[s];if(!o)continue;let l,n;if(typeof o=="function"||"parse"in o)l=s,n=typeof o=="function"?o:o.parse.bind(o);else{const{type:r}=o;l=o.from||s,n=typeof r=="function"?r:r.parse.bind(r)}try{const r=n(e(l));r!==void 0&&(a[s]=r)}catch(r){throw b($,`Unable to parse field "${s}"`,r)}}return a}function k(t){let e=t;if(typeof e=="string"&&(e=JSON.parse(e)),typeof e!="object"||e===null||Array.isArray(e))throw y();return e}function f(t,e){return new E(a=>{const s=k(a);return N(t,o=>s[o])},!1,e)}const d=_(t=>{if(typeof t=="number")return t;if(typeof t=="string"){const e=Number(t);if(!Number.isNaN(e))return e}throw y()},"number"),c=_(t=>{if(typeof t=="string"||typeof t=="number")return t.toString();throw y()},"string");f({req_id:c(),data:t=>t===null?t:c().optional().parse(t)}),f({req_id:c(),result:t=>t,error:c().optional()}),f({height:d(),width:t=>t==null?window.innerWidth:d().parse(t),is_state_stable:p(),is_expanded:p()});f({id:d(),type:c(),title:c(),photoUrl:{type:c().optional(),from:"photo_url"},username:c().optional()},"Chat").optional();f({addedToAttachmentMenu:{type:p().optional(),from:"added_to_attachment_menu"},allowsWriteToPm:{type:p().optional(),from:"allows_write_to_pm"},firstName:{type:c(),from:"first_name"},id:d(),isBot:{type:p().optional(),from:"is_bot"},isPremium:{type:p().optional(),from:"is_premium"},languageCode:{type:c().optional(),from:"language_code"},lastName:{type:c().optional(),from:"last_name"},photoUrl:{type:c().optional(),from:"photo_url"},username:c().optional()},"User").optional();function w(t,e){return t.startsWith(e)?t:`${e}${t}`}function S(t){return new URL(typeof t=="string"?t:`${t.pathname||""}${w(t.search||"","?")}${w(t.hash||"","#")}`,"http://a")}function m(t){const e=typeof t=="string"?t.startsWith("/"):!!(t.pathname&&t.pathname.startsWith("/")),a=S(t);return`${e?a.pathname:a.pathname.slice(1)}${a.search}${a.hash}`}function R(t){const e=h.useCallback(()=>({pathname:t.pathname,search:t.search,hash:t.hash,state:t.state,key:t.id}),[t]),[a,s]=h.useState(e),o=h.useCallback((n,r)=>{const i=typeof n=="string"?n:m(n);if(!i){console.error("Invalid path provided to navigate");return}r!=null&&r.replace?t.replace(i,r.state):t.push(i,r==null?void 0:r.state)},[t]),l=h.useMemo(()=>({go:n=>t.go(n),push:(n,r)=>o(n,{state:r}),replace:(n,r)=>o(n,{replace:!0,state:r}),createHref:n=>t.renderPath(m(n)),encodeLocation:n=>S(t.renderPath(m(n))).toString()}),[t,o]);return h.useEffect(()=>t.on("change",()=>s(e())),[t,e]),[a,l]}function W(t,e){const a=(e==null?void 0:e.base)||"/";return{hook:h.useMemo(()=>()=>{const[o,l]=h.useState(()=>{const i=(t.pathname+t.search+t.hash).replace(/^#!/,"");return i.startsWith(a)?i.slice(a.length)||"/":i});h.useEffect(()=>{const r=()=>{const u=(t.pathname+t.search+t.hash).replace(/^#!/,"");l(u.startsWith(a)?u.slice(a.length)||"/":u)};return t.on("change",r),()=>t.off("change",r)},[]);const n=h.useCallback((r,i)=>{const u=typeof r=="string"?r:m(r),P=`#!${a==="/"?u:`${a}${u.startsWith("/")?u:`/${u}`}`}`;i!=null&&i.replace?t.replace(P,i.state):t.push(P,i==null?void 0:i.state)},[]);return[o,n]},[t,a]),base:a}}exports.createRouterConfig=W;exports.useIntegration=R;
//# sourceMappingURL=index.cjs.map
